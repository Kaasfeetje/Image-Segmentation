(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{21:function(e,t,a){e.exports=a(51)},27:function(e,t,a){},34:function(e,t,a){},35:function(e,t,a){},36:function(e,t,a){},37:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),o=a(7),r=a.n(o),c=a(6),i=a(1),s=a(4),u={points:[],paths:[]},m={layers:[],maskOpacity:1},d=Object(c.b)({nav:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{navIndex:null},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SELECT_NAV":return Object(i.a)(Object(i.a)({},e),{},{navIndex:t.payload});default:return e}},points:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:u,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"ADD_POINT":return Object(i.a)(Object(i.a)({},t),{},{points:[].concat(Object(s.a)(t.points),[a.payload])});case"UPDATE_POINT":return(e=Object(s.a)(t.points))[a.payload.index]=a.payload.point,Object(i.a)(Object(i.a)({},t),{},{points:e});case"FINISHED_PATH":var n=Object(s.a)(t.paths);return n.push(t.points),Object(i.a)(Object(i.a)({},t),{},{points:[],paths:n});case"DELETE_LAST_POINT":return(e=Object(s.a)(t.points)).splice(-1,1),Object(i.a)(Object(i.a)({},t),{},{points:e});case"NEXT_IMAGE":case"PREVIOUS_IMAGE":case"SET_IMAGE":case"RESET":return u;default:return t}},layers:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,a=arguments.length>1?arguments[1]:void 0;switch(a.type){case"ADD_LAYER":return Object(i.a)(Object(i.a)({},t),{},{layers:[].concat(Object(s.a)(t.layers),[a.payload])});case"CHANGE_MASK_OPACITY":return Object(i.a)(Object(i.a)({},t),{},{maskOpacity:a.payload/100});case"MOVE_LAYER_UP":if(e=Object(s.a)(t.layers),a.payload-1>=0){var n=e[a.payload],l=e[a.payload-1];e[a.payload]=l,e[a.payload-1]=n}return Object(i.a)(Object(i.a)({},t),{},{layers:e});case"MOVE_LAYER_DOWN":if(e=Object(s.a)(t.layers),a.payload+1<e.length){var o=e[a.payload],r=e[a.payload+1];e[a.payload]=r,e[a.payload+1]=o}return Object(i.a)(Object(i.a)({},t),{},{layers:e});case"RESET":case"NEXT_IMAGE":case"PREVIOUS_IMAGE":case"SET_IMAGE":return m;default:return t}},colors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{colors:[{name:"Background Class",color:"#000",id:0}],selectedColor:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_COLOR":return Object(i.a)(Object(i.a)({},e),{},{colors:[].concat(Object(s.a)(e.colors),[{name:"Temporary name",color:"#000",id:t.payload.id}])});case"UPDATE_COLOR":var a=Object(s.a)(e.colors);return a[t.payload.id]=t.payload.color,Object(i.a)(Object(i.a)({},e),{},{colors:a});case"SELECT_COLOR":return Object(i.a)(Object(i.a)({},e),{},{selectedColor:t.payload});default:return e}},images:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{images:[],activeImage:0},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"ADD_IMAGE":var a=Object(s.a)(e.images);return console.log(t.payload),a.push(t.payload),Object(i.a)(Object(i.a)({},e),{},{images:a});case"SET_IMAGE":return Object(i.a)(Object(i.a)({},e),{},{activeImage:t.payload});case"NEXT_IMAGE":var n=e.activeImage+1<=e.images.length?e.activeImage+1:e.activeImage;return Object(i.a)(Object(i.a)({},e),{},{activeImage:n});case"PREVIOUS_IMAGE":var l=e.activeImage-1>=0?e.activeImage-1:e.activeImage;return Object(i.a)(Object(i.a)({},e),{},{activeImage:l});default:return e}}}),p=(a(27),a(9)),E=a(3),y=function(e){return{type:"SELECT_NAV",payload:e}},v=function(){return{type:"RESET"}};var f=Object(E.b)((function(e,t){return{selected:e.nav.navIndex===t.id}}),{selectNav:y})((function(e){var t=e.text,a=e.Component,n=e.selectNav,o=e.selected,r=e.id;return l.a.createElement("div",{onClick:function(e){return e.stopPropagation()}},l.a.createElement("button",{onClick:function(){if(o)return n(null);n(r)},className:"header--option"},t,l.a.createElement(p.a,{className:"header--option-icon",icon:"sort-down"})),o&&l.a.createElement(a,null))}));a(34);var g=function(){return l.a.createElement("div",{className:"help"},l.a.createElement("h3",null,"Controls"),l.a.createElement("hr",null),l.a.createElement("div",{className:"help-list"},l.a.createElement("ul",null,l.a.createElement("li",{id:"help-header"},l.a.createElement("span",null,"Key"),l.a.createElement("span",null,"Action")),l.a.createElement("li",null,l.a.createElement("span",null,"Scroll"),l.a.createElement("span",null,"Zoom")),l.a.createElement("li",null,l.a.createElement("span",null,"Left Click"),l.a.createElement("span",null,"Place Point")),l.a.createElement("li",null,l.a.createElement("span",null,"Alt+Left Click")," ",l.a.createElement("span",null,"Pan")),l.a.createElement("li",null,l.a.createElement("span",null,"A"),l.a.createElement("span",null,"Previous Image")),l.a.createElement("li",null,l.a.createElement("span",null,"D"),l.a.createElement("span",null,"Next Image Image")),l.a.createElement("li",null,l.a.createElement("span",null,"Ctrl+Z")," ",l.a.createElement("span",null,"undo")))),l.a.createElement("h3",null,"How to use"),l.a.createElement("p",{style:{marginBottom:"1rem"}},"Use left click to add a point. Use alt left click to pan around. Use scrollwheel to zoom in and out. Use Ctrl + Z to undo the last added point. Move layers up and down in the layers dropdown."),l.a.createElement("p",null,"Version: 0.1.0"))};a(35),a(36);var b=Object(E.b)(null,{moveLayerUp:function(e){return{type:"MOVE_LAYER_UP",payload:e}},moveLayerDown:function(e){return{type:"MOVE_LAYER_DOWN",payload:e}}})((function(e){var t=e.layers,a=e.moveLayerUp,n=e.moveLayerDown;return l.a.createElement("div",{className:"table"},l.a.createElement("div",{className:" table-header table-row"},l.a.createElement("p",null,"Layer"),l.a.createElement("p",null,"Color"),l.a.createElement("p",null,"Layer Name"),l.a.createElement("p",null,"Up/down"),l.a.createElement("p",null,"Delete")),t.map((function(e,t){return l.a.createElement("div",{className:"table-row"},l.a.createElement("p",null,t),l.a.createElement("div",{style:{backgroundColor:"".concat(e.color),minWidth:"15px",minHeight:"15px"}}),l.a.createElement("p",null,e.name),l.a.createElement("div",{className:"table-updown"},l.a.createElement(p.a,{onClick:function(){return function(e){console.log("UP"),a(e)}(t)},className:"table-up",icon:"sort-up"}),l.a.createElement(p.a,{onClick:function(){return function(e){console.log("DOWN"),n(e)}(t)},className:"table-down",icon:"sort-down"})),l.a.createElement("button",{className:"table-button"},"X"))})))}));var O=Object(E.b)((function(e){return{layers:e.layers.layers,maskOpacity:e.layers.maskOpacity}}),{changeMaskOpacity:function(e){return{type:"CHANGE_MASK_OPACITY",payload:e}},reset:v})((function(e){var t=e.layers,a=e.maskOpacity,n=e.changeMaskOpacity,o=e.reset;return l.a.createElement("div",{className:"layers"},l.a.createElement("div",{className:"layers-head"},l.a.createElement("div",{className:"layers-head--mask"},l.a.createElement("p",null,"Mask Opacity"),l.a.createElement("input",{type:"number",min:0,max:100,onChange:function(e){return n(e.target.value)},value:Math.round(100*a)})),l.a.createElement("div",{className:"layers-head--button"},l.a.createElement("button",{onClick:function(){return o()},className:"header--option header--option-dangerous"},"Clear All Layers"))),l.a.createElement("div",{className:"layers-content"},0!==t.length?l.a.createElement(b,{layers:t}):l.a.createElement("p",null,"No Layers Yet")))}));a(37);var h=Object(E.b)((function(e){return{imagesLength:e.images.images.length}}),{addImage:function(e){return{type:"ADD_IMAGE",payload:e}},setImage:function(e){return{type:"SET_IMAGE",payload:e}}})((function(e){var t=e.imagesLength,a=e.addImage,n=e.setImage,o=function(e){var l=new FileReader;l.onload=function(l){var o=new Image;o.onload=function(){var r={file:l.target.result,width:o.width,height:o.height,name:e.name};a(r),n(t)},o.src=l.target.result},l.readAsDataURL(e)};return l.a.createElement("div",{className:"upload-image"},l.a.createElement("h3",{className:"upload-image--header"},"Upload Image"),l.a.createElement("input",{type:"file",accept:"image/*",onChange:function(e){o(e.target.files[0])}}))})),j=a(19),N=function(e){var t=document.querySelector("#image").cloneNode(!0);t.setAttribute("style","backgroundImage:none"),t.childNodes.forEach((function(e){return e.style.opacity=1}));var a="".concat(e.split(".")[0],"-mask.png");Object(j.saveSvgAsPng)(t,a)};var C=Object(E.b)((function(e){return{image:e.images.images[e.images.activeImage]}}),{selectNav:y,reset:v})((function(e){var t=e.image,a=e.selectNav,o=e.reset,r=Object(n.useRef)();return Object(n.useEffect)((function(){var e=function(e){r.current.contains(e.target)||a(null)};return document.body.addEventListener("click",e),function(){document.body.removeEventListener("click",e)}})),l.a.createElement("div",{className:"header"},l.a.createElement("div",{className:"header--logo"},"Image Segmentation"),l.a.createElement("div",{ref:r,className:"header--options"},l.a.createElement(f,{text:"Upload Image",selected:!1,Component:h,id:0}),l.a.createElement(f,{text:"Layers",selected:!1,Component:O,id:1}),l.a.createElement(f,{text:"Help",selected:!1,Component:g,id:3}),l.a.createElement("div",null,l.a.createElement("button",{className:"header--option",onClick:function(){return N(t?t.name:"mask.png")}},"Save")),l.a.createElement("div",null,l.a.createElement("button",{onClick:function(){return o()},className:"header--option header--option-dangerous"},"Reset"))))})),I=a(10),k=a(11);I.b.add(k.c,k.d,k.b,k.a);a(38),a(39);var A=a(5),_=a(20),L=a.n(_);var P=Object(E.b)((function(e){return{points:e.points.points,paths:e.points.paths,layers:e.layers.layers,activeColor:e.colors.colors[e.colors.selectedColor],amountOfLayers:e.layers.layers.length,image:e.images.images[e.images.activeImage],maskOpacity:e.layers.maskOpacity}}),{addPoint:function(e){return{type:"ADD_POINT",payload:e}},updatePoint:function(e,t){return{type:"UPDATE_POINT",payload:{point:e,index:t}}},finishPath:function(){return{type:"FINISHED_PATH"}},addLayer:function(e,t){return{type:"ADD_LAYER",payload:Object(i.a)(Object(i.a)({},e),{},{id:t})}},deleteLastPoint:function(){return{type:"DELETE_LAST_POINT"}},nextImage:function(){return{type:"NEXT_IMAGE"}},previousImage:function(){return{type:"PREVIOUS_IMAGE"}}})((function(e){var t,a=e.points,o=e.layers,r=e.paths,c=e.activeColor,i=e.amountOfLayers,s=e.image,u=e.maskOpacity,m=e.addLayer,d=e.updatePoint,p=e.deleteLastPoint,E=e.finishPath,y=e.addPoint,v=e.nextImage,f=e.previousImage,g=Object(n.useState)({x:0,y:0,scale:1}),b=Object(A.a)(g,2),O=b[0],h=b[1],j=Object(n.useState)(!1),C=Object(A.a)(j,2),I=C[0],k=C[1],_=Object(n.useState)(null),P=Object(A.a)(_,2),D=P[0],S=P[1],T=Object(n.useRef)();Object(n.useEffect)((function(){(t=L()(document.querySelector("#image"),{maxZoom:20,minZoom:.1,smoothScroll:!1,beforeMouseDown:function(e){return!e.altKey}})).zoomTo(O.x,O.y,O.scale),t.moveTo(O.x,O.y)}),[a]);var w=function(e){var t=T.current.getBoundingClientRect(),a=T.current.style.transform.split(","),n=a[0].replace("matrix(",""),l=a[3];return{x:(e.clientX-t.left)/n,y:(e.clientY-t.top)/l}},M=a.map((function(e,t){return l.a.createElement("circle",{key:e,cx:e.split(",")[0],cy:e.split(",")[1],r:"5",stroke:"black",fill:"red",strokeWidth:"2",onClick:function(e){return e.stopPropagation()},onMouseDown:function(e){return function(e,t){if(!e.altKey){k(!0);var a=w(e),n=a.x,l=a.y;d("".concat(n,",").concat(l),t),S(t),e.stopPropagation()}}(e,t)}})}));return l.a.createElement("div",{className:"canvas",onMouseUp:function(e){return k(!1)},onMouseMove:function(e){return function(e,t){if(I){if(e.altKey)return;var a=w(e),n=a.x,l=a.y;d("".concat(n,",").concat(l),t),e.stopPropagation()}}(e,D)},onKeyDown:function(e){return function(e){"Enter"===e.key&&(m(c,i),E()),e.ctrlKey&&"z"===e.key&&p(),"d"===e.key&&v(),"a"===e.key&&f(),83==e.keyCode&&(navigator.platform.match("Mac")?e.metaKey:e.ctrlKey)&&(e.preventDefault(),N(s?s.name:"mask.png"))}(e)}},l.a.createElement("svg",{ref:T,style:{backgroundImage:void 0===s?"url(logo512.png)":"url(".concat(s.file,")")},onClick:function(e){if(!e.altKey){var a=w(e),n=a.x,l=a.y;console.log("".concat(n,",").concat(l)),t&&h(t.getTransform()),y("".concat(n,",").concat(l))}},id:"image",width:void 0===s?"512":s.width,height:void 0===s?"512":s.height},l.a.createElement("polyline",{points:a,strokeWidth:"3",style:{stroke:"white",fill:"none"}}),M,o.map((function(e){return l.a.createElement("polygon",{key:e.id,points:r[e.id],style:{stroke:"none",fill:"".concat(e.color),opacity:u}})}))))}));a(49);var D=function(e){var t=e.title,a=e.content,n=e.actions,o=e.onDismiss;return r.a.createPortal(l.a.createElement("div",{onClick:o,className:"modal"},l.a.createElement("div",{onClick:function(e){return e.stopPropagation()},className:"modal-content"},l.a.createElement("div",{className:"modal-header"},t),l.a.createElement("div",{className:" modal-contentbox"},a),l.a.createElement("div",{className:" modal-actions"},n))),document.querySelector("#modal"))};a(50);var S=Object(E.b)((function(e){return{selectedColor:e.colors.selectedColor}}),{updateColor:function(e,t,a){return{type:"UPDATE_COLOR",payload:{id:e,color:{id:e,name:t,color:a}}}},selectColor:function(e){return{type:"SELECT_COLOR",payload:e}}})((function(e){var t=e.color,a=e.selectedColor,o=e.selectColor,r=e.updateColor,c=Object(n.useState)(!1),i=Object(A.a)(c,2),s=i[0],u=i[1],m=Object(n.useState)(t.color),d=Object(A.a)(m,2),p=d[0],E=d[1],y=Object(n.useState)(t.name),v=Object(A.a)(y,2),f=v[0],g=v[1];return l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{style:{backgroundColor:t.color,color:"white",border:a!==t.id?"none":"2px dotted green",padding:"1rem"},className:"layer",onClick:function(e){a===t.id?u(!0):o(t.id)}},t.name),!0===s&&l.a.createElement(D,{title:"Pick A Color",content:l.a.createElement(l.a.Fragment,null,l.a.createElement("div",{className:"modal-form-item"},l.a.createElement("label",{htmlFor:"name"},"Name: "),l.a.createElement("input",{onChange:function(e){return g(e.target.value)},placeholder:f,id:"name",type:"text"})),l.a.createElement("div",{className:"modal-form-item"},l.a.createElement("label",{htmlFor:"color"},"Colorpicker: "),l.a.createElement("input",{onChange:function(e){return E(e.target.value)},placeholder:p,id:"color",type:"color"}))),actions:l.a.createElement(l.a.Fragment,null,l.a.createElement("button",{onClick:function(){return u(!1)},className:"modal-button modal-button-negative"},"Close"),l.a.createElement("button",{onClick:function(e){r(t.id,""==f?t.name:f,void 0==p?t.color:p),u(!1)},className:"modal-button modal-button-positive"},"Save")),onDismiss:function(){return u(!1)}}))}));var T=Object(E.b)((function(e){return{colors:e.colors.colors}}),{addColor:function(e){return{type:"ADD_COLOR",payload:{id:e}}}})((function(e){var t=e.colors,a=void 0===t?[]:t,n=e.addColor,o=a.map((function(e){return l.a.createElement(S,{key:e.id,color:e})}));return l.a.createElement("ul",{className:"main-sidebar"},o,l.a.createElement("button",{onClick:function(){n(a.length)}},"Add Class"))}));var w=function(){return l.a.createElement("div",{className:"main"},l.a.createElement(T,null),l.a.createElement(P,null))};var M=function(){return l.a.createElement("div",{className:"app"},l.a.createElement(C,null),l.a.createElement(w,null))},x=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.c,R=Object(c.d)(d,x());r.a.render(l.a.createElement(E.a,{store:R},l.a.createElement(M,null)),document.querySelector("#root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.68e2e2aa.chunk.js.map